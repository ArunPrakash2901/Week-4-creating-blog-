---
title: "Where Should You Start Your Career?"
author: "Arun Krishnasamy"
date: "2024-08-13"
categories: [Post]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      eval = TRUE, 
                      cache = FALSE, 
                      warning = FALSE, 
                      message = FALSE)
options(width=80, digits=3)
```

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(gt)
library(readr)
library(broom)
library(kableExtra)
library(readxl)
library(janitor)
```

```{r}
df <- read_excel("data/data.xlsx", sheet = 2)
df <- df |> 
  clean_names()
```

```{r}

df_clean <- df |>
  filter(activity_at_age_19_employment_with_earnings_above_0 != "*") |>
  mutate(Employment_Rate = as.numeric(activity_at_age_19_employment_with_earnings_above_0), 
    Size_Classification = as.factor(size_flag) 
  ) |> 
  filter(!Size_Classification %in% c("Inner London BUA", "Outer london BUA", "Not BUA", "Other Small BUAs"))

```

```{r}
employ_distri <- ggplot(df_clean, aes(x = Size_Classification, y = Employment_Rate)) +
  geom_boxplot(fill = "steelblue") +
  labs(title = "Employment Rate Distribution at Age 19 by Town Size",
       x = "Town Size Classification",
       y = "Employment Rate (%)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

```{r}

employment_summary <- df_clean |> 
  group_by(Size_Classification) |> 
  summarise(Average_Employment_Rate = mean(Employment_Rate, na.rm = TRUE))

```

```{r}
# Perform ANOVA if there are more than two levels
anova_result <- aov(Employment_Rate ~ Size_Classification, data = df_clean)

anova_tbl <- tidy(anova_result)

```

```{r, Post-hoc test}

# Perform Tukey's HSD post-hoc test
posthoc_result <- TukeyHSD(anova_result) |> 
  tidy() |> 
  select(-term, -null.value)


```

```{r}
tukey_hsd <- ggplot(posthoc_result, aes(x = estimate, y = reorder(contrast, estimate))) +
  geom_point(aes(color = adj.p.value < 0.05), size = 3) + 
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) + 
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  labs(x = "Mean Difference (Estimate)", y = "Contrast", title = "Tukey HSD Post-hoc Test Results") +
  theme_minimal() +
  scale_color_manual(values = c("TRUE" = "blue", "FALSE" = "black")) +
  theme(legend.position = "none")
```

```{r}
data_dict <- read_csv("data/key_variables.csv")

dictionary <- data_dict %>%
  gt() %>%
  tab_header(
    title = md("**Data Dictionary**"),
    subtitle = md("Description of Variables")
  ) %>%
  cols_label(
    variable = md("**Variable Name**"),
    class = md("**Data Type**"),
    description = md("**Description**")
  ) %>%
  fmt_markdown(columns = vars(description)) %>%
  cols_width(
    vars(variable) ~ px(120),  # Adjust width for variable column
    vars(class) ~ px(100),     # Adjust width for class column
    vars(description) ~ px(300) # Adjust width for description column
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#f0f0f0"),
      cell_borders(sides = "all", color = "gray", weight = px(1)),
      cell_text(weight = "bold", color = "#333333", font = "Arial")
    ),
    locations = cells_column_labels(columns = everything())
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#fafafa"),
      cell_borders(sides = "all", color = "lightgray", weight = px(0.5)),
      cell_text(align = "left", font = "Arial")
    ),
    locations = cells_body(columns = everything())
  ) %>%
  tab_options(
    table.border.top.color = "transparent",
    table.border.bottom.color = "transparent",
    heading.align = "center",
    column_labels.border.top.color = "gray",
    column_labels.border.bottom.color = "gray",
    table.font.size = px(10)  # Reduce font size
  ) %>%
  opt_table_outline() %>%
  opt_table_font(font = "Arial")

```

You might think that moving to a big city is the sure way to find a job, especially when you're just starting out at 19. But what if I told you that small towns actually offer better job prospects for young adults? It’s true! Data shows that 19-year-olds living in smaller towns have higher employment rates than those in big cities. And the more we look into it, the more the data reveals that size does matter when it comes to landing that first job.

The study looked at employment rates across four types of towns—small, medium, large, and cities in UK. While cities are often seen as places full of opportunity, the numbers tell a different story. Small towns had the highest median employment rates, while cities, with all their hustle and bustle, had the lowest.

```{r}
#| label: fig-boxplot
#| fig-cap: "The distribution of employment rates at age 19 across different town sizes. Cities have the lowest median and largest variation, while Small Towns have the highest variation but a median similar to Medium and Large Towns."
#| fig-height: 4
employ_distri
```

To make sure these differences weren’t just random flukes, we compared the employment data across the different town sizes. Imagine it like a reality show where each town size competes to prove it offers better job prospects, and this in statistics is known as **ANOVA**. And as we reviewed each contestant’s performance, the results @tbl-anova became crystal clear: small and medium towns consistently came out on top when it came to employment rates, leaving cities trailing behind.

```{r}
#| label: tbl-anova
#| tbl-cap: "ANOVA Results for the Effect of Town Size Classification on Employment Rates at Age 19"
kableExtra::kable(anova_tbl)
```

Now, you might wonder: how did we figure this out without just taking the numbers at face value? Think of it this way—when you’re comparing the job market in different places, there are a lot of factors that could skew the results. So, to be extra sure, we had to put the data through a "fairness filter", and the filter I am referring to is the **post-hoc Tukey HSD test**. This filter looks at all the town sizes and checks whether the differences in job rates are big enough to be meaningful, or if they might just be due to random chance.

And what did the filter show?@tbl-posthoc

```{r}
#| label: tbl-posthoc
#| tbl-cap: "Tukey HSD test results showing significant differences in employment rates between town sizes."
kable(posthoc_result) |> 
  kable_styling(font_size = 10) 
```

Small towns really do provide better chances for young adults to get a job. To get even more specific, we looked at each pair of town sizes to figure out which ones truly stand apart.

```{r}
#| label: fig-HSD
#| fig.cap: "The figure provides a quick visual overview of which pairwise comparisons are significant."
#| fig-height: 3.5
  
tukey_hsd
```

The conclusion was loud and clear: young people in small and medium towns had a significantly better shot at finding jobs than those in the big cities.

# Why would this be the case?

The reasons seem to distill down to a few key factors.

First, in smaller towns, there’s less competition for available jobs. While cities may have thousands of openings, they also have thousands of applicants. In smaller towns, job seekers are often competing with a much smaller pool of candidates, making it easier to land a job.

Another factor is networking. In small towns, personal connections can play a big role in getting your foot in the door. Knowing the local shop owner or a family friend who works at the factory might be just the edge you need. In big cities, where many people are outsiders, these networks don’t function as effectively.

One more factor could be the perception of the available jobs. Young adults in cities might feel overwhelmed or discouraged by the high competition, or they might not even be aware of entry-level positions that aren’t as visible among the numerous listings for more experienced candidates. In smaller towns, job openings might be fewer, but they’re often better suited for young people just starting out in their careers.

Interestingly, this pattern holds even across medium and large towns, which also outperformed cities, though to a lesser extent than small towns.

This study challenges the long-held belief that moving to the city is the best path to career success. For many young adults, the reverse might be true. Cities may offer more options on paper, but small towns provide better chances of landing that first job. For policymakers, this suggests a need to focus on supporting young adults in cities, where high competition and saturation are real barriers.

This analysis was conducted using data from the [TidyTuesdayR](https://github.com/rfordatascience/tidytuesday/blob/master/data/2024/2024-01-23/readme.md) project, sourced from R for Data Science (2024). Employment rates for 19-year-olds were compared across different town sizes using statistical methods, confirming that smaller towns offer better employment prospects for young adults than big cities.

*Data sources: R for Data Science (TidyTuesday dataset: Employment Rates), UK Government (Town size and demographic data), Census 2011 (Population and employment data).*

ONS. (2023).Why Do Children and Young People in Smaller Towns Do Better Academically Than Those in Larger Towns? [Office for National Statistics](https://www.ons.gov.uk/peoplepopulationandcommunity/educationandchildcare/articles/whydochildrenandyoungpeopleinsmallertownsdobetteracademicallythanthoseinlargertowns/2023-07-25)
